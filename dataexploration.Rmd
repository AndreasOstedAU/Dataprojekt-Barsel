---
title: "Data exploration - barsel"
author: "Andreas"
date: "3/3/2022"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(readxl)
```

Alt data fra BARSEL04 - både total antal dage, antal forældre (far/mor), og gennemsnit antal dage - alt efter år, uddannelse og landsdel. 

# Gennemsnit antal dage efter landsddel, uddannelse, år, kun far (far berettiget til barsel):
```{r}
FarUddGnsDage <- read_xlsx("Data/Landsdele_Udd_AntalDage_Far.xlsx")
FarUddGnsDage
```
Sammenlign med ud og uden interaktion
```{r}
LM_far <- lm(data = FarUddGnsDage, Dage ~ Uddannelse + Landsdel + År + Uddannelse*Landsdel)
summary(LM_far)
LM_smaller <- lm(data = FarUddGnsDage, Dage ~ Uddannelse + Landsdel + År)
summary(LM_smaller)
```
Test for signifikans med ANOVA:

```{r}
anova(LM_far, LM_smaller)
```

Visualering: evt. hiv enkelte landsdele ud til sammenligning.


# Gennesnit antal dage efter landsdel, uddannelse, år, kun mor (mor berettiget til barsel)
```{r}
MorUddGnsDage <- read_xlsx("Data/Landsdele_Udd_AntalDage_Mor.xlsx",na = '..')
MorUddGnsDage
```

```{r}
LM_mor <- lm(data = MorUddGnsDage, Dage ~ Uddannelse + Landsdel + År + Uddannelse*Landsdel)
summary(LM_mor)
LM_mor_smaller <- lm(data = MorUddGnsDage, Dage ~ Uddannelse + Landsdel + År)
summary(LM_mor_smaller)
```
```{r}
anova(LM_mor, LM_mor_smaller)
```

# Joinet gennemsnit antal dage efter uddannelse, landsdel og år, far og mor:

```{r}
FarMorUddGnsDage <- full_join(FarUddGnsDage, MorUddGnsDage, by = c("Landsdel", "Uddannelse", "År"), suffix = c("Far", "Mor"))
FarMorUddGnsDage
```
## Model
```{r}
FarMor_long <- FarMorUddGnsDage %>% 
  rename(Far = DageFar,
         Mor = DageMor) %>% 
  pivot_longer(c(Far, Mor), 
               names_to = "Forælder", 
               values_to = "Dage")
FarMor_long
```


```{r}
LMtotal <- lm(data = FarMor_long, Dage ~ Forælder + Landsdel + Uddannelse + Uddannelse*Landsdel + Uddannelse*Forælder)
summary(LMtotal)
```

# Antal dage total i stedet for gennemsnit

## Antal dage total for kvinder i landsdele efter uddannelse og år:
```{r}
MorUddTotalDage <- read_xlsx("Data/Landsdele_Udd_AntalDageTotal_Mor.xlsx", na = '..')
MorUddTotalDage
```
## Antal kvinder per landdsdele med uddannelse per år (mor berettiget til barsel). 

```{r}
AntalUddLandsDeleKvinder <- read_xlsx("Data/AntalUddLandsdeleKvinder.xlsx", na = '..')
AntalUddLandsDeleKvinder_long <- AntalUddLandsDeleKvinder %>% pivot_longer(c(3:7), names_to = "År", values_to = "Antal_med_udd.")
AntalUddLandsDeleKvinder_long
```
## Join af kvinder efter uddannelse, landsdel, år og antal med uddannelse:

```{r}
Total_kvinder <- full_join(MorUddTotalDage, AntalUddLandsDeleKvinder_long, by = c("Uddannelse", "Landsdel", "År"))
Total_kvinder
```
#Antal dage per kvinde
```{r}
Dage_per_kvinde <- Total_kvinder %>% mutate(Dage_per_person = Antal_dage_total/Antal_med_udd.)
Dage_per_kvinde
```

## Model:
```{r}
lm(data = Dage_per_kvinde, Antal_dage_total ~ Uddannelse + Landsdel + Antal_med_udd. + Uddannelse*Landsdel) %>% summary()
```


## Antal dage total for mænd efter landsdele, uddannelse og år:
```{r}
FarUddTotalDage <- read_xlsx("Data/Landsdele_Udd_AntalDageTotal_Far.xlsx", na = '..')
FarUddTotalDage
```


## Antal mænd per landdsdele efter uddannelse og år. 
```{r}
AntalUddLandsDeleMænd <- read_xlsx("Data/AntalUddLandsdeleMænd.xlsx")
AntalUddLandsDeleMænd_long <- AntalUddLandsDeleMænd %>% pivot_longer(c(3:7), names_to = "År", values_to = "Antal_med_udd.")
AntalUddLandsDeleMænd_long
```
## Join af mænd efter uddannelse, landsdel, år og antal med uddannelse:
```{r}
Total_mænd <- full_join(FarUddTotalDage, AntalUddLandsDeleMænd_long, by = c("Uddannelse", "Landsdel", "År"))
Total_mænd
```
#Antal dage per mand
```{r}
Dage_per_mand <- Total_mænd %>% mutate(Dage_per_person = Antal_dage_total/Antal_med_udd.)
Dage_per_mand
```



# join af begge køn
```{r}
FarMorUddTotalDage <- full_join(Total_mænd, Total_kvinder, by = c("Landsdel", "Uddannelse", "År"), suffix = c("_Far", "_Mor")) 
FarMorUddTotalDage
```

Måske gøre lignende inden for brancher?


# OECD paid father-specific leave
Antal uger betalt barsel for fædre i forskellige lande, forskellige år.

```{r}
OECD_Data <- read_xlsx("Data/OECD_nordiskelande_barsel_mænd.xlsx", na = "..")
OECD_Data 
```

```{r}
OECD_Long <- OECD_Data %>% pivot_longer(c(2:21), names_to = "Year", values_to = "Weeks")
OECD_Long
```

```{r}
OECD_long_filtered <- OECD_Long %>% filter(as.numeric(Year) >= 2000)
```


```{r}
OECD_long_filtered %>% ggplot +
  geom_bar(mapping = aes(x = Year, y = Weeks, fill = Country), stat = 'Identity', position = 'dodge')
```
My little pony plot :))

Sammenlign med fødselstal (reproduktionstal) for lande med store udsving.


# Brancher og social status (BARSEL11)

## Far gennemsnitlig antal dage efter år, branche, social status
```{r}
GnsDageFarBrancher <- read_xlsx("Data/GnsDageFarBrancherStatus.xlsx", na = '..')
GnsDageFarBrancher_long <- GnsDageFarBrancher %>% pivot_longer(c(3:7), names_to = "År", values_to = "Gns._Dage")
GnsDageFarBrancher_long
```
### Model
```{r}
LM_far_brancher <- lm(data = GnsDageFarBrancher_long, Gns._Dage ~ År + Branche + Social_status + Branche*Social_status)
summary(LM_far_brancher)
```
Undersøg hvem der har adgang til barsel med fuld løn i forskellige brancher.


## Mor gennemsnitlig antal dage (efter fødsel) efter år, branche, social status
```{r}
GnsDageMorBrancher <- read_xlsx("Data/GnsDageMorBrancherStatus.xlsx", na = '..')
GnsDageMorBrancher_long <- GnsDageMorBrancher %>% pivot_longer(c(3:7), names_to = "År", values_to = "Gns._Dage")
GnsDageMorBrancher_long
```

### Model
```{r}
LM_far_brancher <- lm(data = GnsDageFarBrancher_long, Gns._Dage ~ År + Branche + Social_status + Branche*Social_status)
summary(LM_far_brancher)
```

Har offentligt ansatte akademikere og kommunalt ansætte sosu assistenter samme adgang til barselspenge? 
